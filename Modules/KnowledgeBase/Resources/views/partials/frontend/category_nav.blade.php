@php
    if (isset($target_elm)) {
        $target_elm = $target_elm;
    } else {
        $target_elm = 'kb-category-nav';

    }
@endphp

@if (count($categories))
    @foreach ($categories as $category)
    	<div class="kb-category-nav-item">
    		@php
                if (!isset($selected_category_id)) {
                    $selected_category_id = null;
                }

                $subcategories = $category->categories;
    			$collapsable_category = ($subcategories);
    			$has_selected_child = isset($selected_category_id) ? $category->hasChildWithId($selected_category_id) : null;
    		@endphp
    		@if ($collapsable_category)
                @if (isset($category->icon_file))
                    <a href="#{{ $target_elm }}-collapse-{{ $category->id }}" class="kb-nav-item-has-icon" data-toggle="collapse">
                        <img src='/img/{{ $category->icon_file }}' class='' width='20' height='20' alt='{{ $category->name }} Icon'><span class="kb-category-nav-name">{{ $category->name }}<span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="11" height="12" viewBox="0 0 11 12" fill="none">
                            <path d="M4.11796 1.91694L4.11796 7.23332L2.03335 5.16731C1.56833 4.70644 0.813772 4.70644 0.34876 5.16731C-0.116252 5.62817 -0.116252 6.376 0.34876 6.83686L4.46744 10.9188L4.46816 10.9195C4.4956 10.9467 4.52448 10.9725 4.55409 10.9968C4.56781 11.0082 4.58297 11.0183 4.59669 11.0283C4.6133 11.0404 4.6299 11.0533 4.64723 11.0655C4.66456 11.0769 4.68189 11.087 4.69994 11.097C4.71583 11.1063 4.73099 11.1163 4.7476 11.1249C4.76565 11.1342 4.7837 11.1421 4.80248 11.1507C4.81981 11.1585 4.83642 11.1671 4.85375 11.1743C4.8718 11.1814 4.88985 11.1871 4.90718 11.1936C4.92595 11.2 4.944 11.2072 4.9635 11.2129C4.98155 11.2186 4.9996 11.2222 5.01766 11.2265C5.03715 11.2315 5.05665 11.2365 5.07686 11.2408C5.0978 11.2451 5.11874 11.2473 5.13968 11.2501C5.15701 11.2523 5.17434 11.2558 5.19167 11.2573C5.26966 11.2652 5.34836 11.2652 5.42707 11.2573C5.4444 11.2558 5.46173 11.2523 5.47906 11.2501C5.5 11.2473 5.52094 11.2444 5.54188 11.2408C5.5621 11.2372 5.58087 11.2315 5.60109 11.2265C5.61914 11.2222 5.63719 11.2179 5.65524 11.2129C5.67402 11.2072 5.69279 11.2 5.71156 11.1936C5.72961 11.1871 5.74767 11.1814 5.765 11.1743C5.78233 11.1671 5.79893 11.1585 5.81626 11.1507C5.83431 11.1421 5.85309 11.1342 5.87114 11.1249C5.88775 11.1163 5.90291 11.1063 5.9188 11.097C5.93613 11.087 5.95418 11.0769 5.97151 11.0655C5.98884 11.054 6.00545 11.0412 6.02205 11.0283C6.03649 11.0175 6.05094 11.0075 6.06465 10.9968C6.09498 10.9725 6.12314 10.9467 6.15058 10.9195L6.1513 10.9188L10.1776 6.92846C10.4101 6.69803 10.5263 6.39604 10.5263 6.09333C10.5263 5.79062 10.4101 5.48862 10.1776 5.25819C9.71255 4.79733 8.95798 4.79733 8.49297 5.25819L6.50006 7.23332L6.50006 1.91765C6.50006 1.26572 5.96645 0.736869 5.30865 0.736869C4.65085 0.736869 4.11724 1.26572 4.11724 1.91765L4.11796 1.91694Z" fill="#1F583C"></path>
                        </svg>
                    </a>
                @else
                    <a href="#{{ $target_elm }}-collapse-{{ $category->id }}" data-toggle="collapse">
                        {{ $category->name }}
                        <svg xmlns="http://www.w3.org/2000/svg" width="11" height="12" viewBox="0 0 11 12" fill="none">
                            <path d="M4.11796 1.91694L4.11796 7.23332L2.03335 5.16731C1.56833 4.70644 0.813772 4.70644 0.34876 5.16731C-0.116252 5.62817 -0.116252 6.376 0.34876 6.83686L4.46744 10.9188L4.46816 10.9195C4.4956 10.9467 4.52448 10.9725 4.55409 10.9968C4.56781 11.0082 4.58297 11.0183 4.59669 11.0283C4.6133 11.0404 4.6299 11.0533 4.64723 11.0655C4.66456 11.0769 4.68189 11.087 4.69994 11.097C4.71583 11.1063 4.73099 11.1163 4.7476 11.1249C4.76565 11.1342 4.7837 11.1421 4.80248 11.1507C4.81981 11.1585 4.83642 11.1671 4.85375 11.1743C4.8718 11.1814 4.88985 11.1871 4.90718 11.1936C4.92595 11.2 4.944 11.2072 4.9635 11.2129C4.98155 11.2186 4.9996 11.2222 5.01766 11.2265C5.03715 11.2315 5.05665 11.2365 5.07686 11.2408C5.0978 11.2451 5.11874 11.2473 5.13968 11.2501C5.15701 11.2523 5.17434 11.2558 5.19167 11.2573C5.26966 11.2652 5.34836 11.2652 5.42707 11.2573C5.4444 11.2558 5.46173 11.2523 5.47906 11.2501C5.5 11.2473 5.52094 11.2444 5.54188 11.2408C5.5621 11.2372 5.58087 11.2315 5.60109 11.2265C5.61914 11.2222 5.63719 11.2179 5.65524 11.2129C5.67402 11.2072 5.69279 11.2 5.71156 11.1936C5.72961 11.1871 5.74767 11.1814 5.765 11.1743C5.78233 11.1671 5.79893 11.1585 5.81626 11.1507C5.83431 11.1421 5.85309 11.1342 5.87114 11.1249C5.88775 11.1163 5.90291 11.1063 5.9188 11.097C5.93613 11.087 5.95418 11.0769 5.97151 11.0655C5.98884 11.054 6.00545 11.0412 6.02205 11.0283C6.03649 11.0175 6.05094 11.0075 6.06465 10.9968C6.09498 10.9725 6.12314 10.9467 6.15058 10.9195L6.1513 10.9188L10.1776 6.92846C10.4101 6.69803 10.5263 6.39604 10.5263 6.09333C10.5263 5.79062 10.4101 5.48862 10.1776 5.25819C9.71255 4.79733 8.95798 4.79733 8.49297 5.25819L6.50006 7.23332L6.50006 1.91765C6.50006 1.26572 5.96645 0.736869 5.30865 0.736869C4.65085 0.736869 4.11724 1.26572 4.11724 1.91765L4.11796 1.91694Z" fill="#1F583C"></path>
                        </svg>
                    </a>
                @endif
        	@else
                @if (isset($category->icon_file))
        		    <a href="{{ $category->urlFrontend($mailbox) }}" class="@if ($selected_category_id == $category->id) kb-selected @endif kb-nav-item-has-icon"><img src='/img/{{ $category->icon_file }}' class='' width='20' height='20' alt='{{ $category->name }} Icon'><span class="kb-category-nav-name">{{ $category->name }}</span></a>
                @else
                    <a href="{{ $category->urlFrontend($mailbox) }}" class="@if ($selected_category_id == $category->id) kb-selected @endif">{{ $category->name }}</a>
                @endif
        	@endif
        	@if ($category->id == $selected_category_id
        		|| $has_selected_child
        		|| $collapsable_category
        	)
        		@if ($collapsable_category)<div id="{{ $target_elm }}-collapse-{{ $category->id }}" @if (!$has_selected_child) class="collapse @if ($selected_category_id == $category->id) in @endif" @endif>@endif
        			@include('knowledgebase::partials/frontend/category_nav', ['categories' => $subcategories])
        		@if ($collapsable_category)</div>@endif
        	@endif
        </div>
    @endforeach
@endif
